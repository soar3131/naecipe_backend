# Feature Specification: 원본 레시피 기본 CRUD

**Feature Branch**: `004-recipe-basic-crud`
**Created**: 2025-12-10
**Status**: Draft
**Input**: User description: "SPEC-004 - 원본 레시피 기본 CRUD: 크롤링으로 수집된 원본 레시피 관리, 레시피 상세/목록/인기 조회, 요리사별 레시피 조회"

---

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 레시피 상세 조회 (Priority: P1)

사용자가 관심 있는 레시피를 클릭하면 상세 정보(제목, 설명, 재료, 조리 단계, 영양 정보, 태그, 요리사 정보)를 볼 수 있다. 이를 통해 사용자는 해당 레시피를 조리할지 결정할 수 있다.

**Why this priority**: Core Loop의 핵심 진입점. 사용자가 레시피를 저장하거나 조리를 시작하려면 먼저 상세 정보를 확인해야 함.

**Independent Test**: 레시피 ID로 상세 페이지를 요청하면 모든 정보(재료, 조리 단계, 요리사 정보 포함)가 표시되는지 확인.

**Acceptance Scenarios**:

1. **Given** 유효한 레시피 ID가 있을 때, **When** 사용자가 레시피 상세를 조회하면, **Then** 레시피의 제목, 설명, 썸네일, 조리시간, 난이도, 인분수가 표시된다.
2. **Given** 유효한 레시피 ID가 있을 때, **When** 사용자가 레시피 상세를 조회하면, **Then** 재료 목록(재료명, 양, 단위, 대체 재료)이 순서대로 표시된다.
3. **Given** 유효한 레시피 ID가 있을 때, **When** 사용자가 레시피 상세를 조회하면, **Then** 조리 단계(순서, 설명, 소요시간, 팁)가 순서대로 표시된다.
4. **Given** 유효한 레시피 ID가 있을 때, **When** 사용자가 레시피 상세를 조회하면, **Then** 해당 레시피를 만든 요리사 정보(이름, 프로필 이미지, 전문 분야)가 표시된다.
5. **Given** 유효한 레시피 ID가 있을 때, **When** 사용자가 레시피 상세를 조회하면, **Then** 레시피에 연결된 태그 목록이 표시된다.
6. **Given** 존재하지 않는 레시피 ID로 조회할 때, **When** 사용자가 레시피 상세를 요청하면, **Then** "레시피를 찾을 수 없습니다" 오류 메시지가 표시된다.

---

### User Story 2 - 레시피 목록 조회 (Priority: P1)

사용자가 앱에 진입하면 레시피 목록을 탐색할 수 있다. 페이지네이션을 통해 많은 레시피를 효율적으로 탐색하고, 무한 스크롤 형태로 더 많은 레시피를 로드할 수 있다.

**Why this priority**: Core Loop의 시작점. 사용자가 레시피를 발견하는 첫 번째 접점.

**Independent Test**: 레시피 목록 요청 시 페이지네이션된 결과가 반환되고, 다음 페이지 요청이 가능한지 확인.

**Acceptance Scenarios**:

1. **Given** 레시피가 등록되어 있을 때, **When** 사용자가 레시피 목록을 조회하면, **Then** 레시피 카드(썸네일, 제목, 요리사명, 조리시간, 난이도, 평점)가 표시된다.
2. **Given** 레시피가 20개 이상 있을 때, **When** 사용자가 첫 페이지를 조회하면, **Then** 기본 20개의 레시피와 다음 페이지 커서가 반환된다.
3. **Given** 다음 페이지 커서가 있을 때, **When** 사용자가 다음 페이지를 요청하면, **Then** 다음 20개의 레시피가 반환된다.
4. **Given** 마지막 페이지에 도달했을 때, **When** 사용자가 다음 페이지를 요청하면, **Then** 빈 목록과 더 이상 페이지 없음 표시가 반환된다.

---

### User Story 3 - 인기 레시피 조회 (Priority: P2)

사용자가 인기 레시피를 조회하면 조회수, 저장수, 조리 완료수를 기반으로 계산된 인기 레시피 목록을 볼 수 있다. 이를 통해 많은 사람들이 선호하는 레시피를 쉽게 발견할 수 있다.

**Why this priority**: 사용자 참여를 높이는 발견 기능. 기본 CRUD 이후 추가 가치 제공.

**Independent Test**: 인기 레시피 목록 요청 시 인기도 점수 기준 정렬된 결과가 반환되는지 확인.

**Acceptance Scenarios**:

1. **Given** 레시피들이 등록되어 있을 때, **When** 사용자가 인기 레시피를 조회하면, **Then** 인기도 점수(조회수, 저장수, 조리수 기반) 기준 내림차순으로 정렬된 레시피가 표시된다.
2. **Given** 카테고리별 인기 레시피를 조회할 때, **When** 특정 카테고리(한식, 양식 등)를 선택하면, **Then** 해당 카테고리 내에서 인기 있는 레시피만 표시된다.
3. **Given** 인기 레시피 목록을 조회할 때, **When** 결과가 10개를 초과하면, **Then** 상위 10개의 레시피만 표시된다.

---

### User Story 4 - 요리사 목록 및 상세 조회 (Priority: P2)

사용자가 요리사(셰프, 유튜버, 인플루언서) 목록을 탐색하고, 특정 요리사의 프로필과 활동 플랫폼 정보를 볼 수 있다. 이를 통해 관심 있는 요리사를 발견하고 팔로우할 수 있다.

**Why this priority**: 요리사 중심 탐색은 레시피 발견의 중요한 경로. 기본 레시피 조회 이후 추가 가치 제공.

**Independent Test**: 요리사 목록 및 상세 조회 시 프로필 정보와 플랫폼 정보가 올바르게 표시되는지 확인.

**Acceptance Scenarios**:

1. **Given** 요리사들이 등록되어 있을 때, **When** 사용자가 요리사 목록을 조회하면, **Then** 요리사 카드(프로필 이미지, 이름, 전문 분야, 레시피 수)가 표시된다.
2. **Given** 유효한 요리사 ID가 있을 때, **When** 사용자가 요리사 상세를 조회하면, **Then** 요리사의 프로필(이름, 소개, 전문 분야, 총 조회수, 평균 평점, 검증 여부)이 표시된다.
3. **Given** 유효한 요리사 ID가 있을 때, **When** 사용자가 요리사 상세를 조회하면, **Then** 요리사의 활동 플랫폼 목록(유튜브, 인스타그램, 블로그 등)과 각 플랫폼의 URL, 구독자 수가 표시된다.
4. **Given** 인기 요리사를 조회할 때, **When** 사용자가 인기 요리사 목록을 요청하면, **Then** 레시피 수, 총 조회수, 평균 평점 기준으로 정렬된 요리사가 표시된다.

---

### User Story 5 - 요리사별 레시피 조회 (Priority: P2)

사용자가 특정 요리사를 선택하면 해당 요리사가 만든 모든 레시피를 볼 수 있다. 이를 통해 좋아하는 요리사의 레시피를 한눈에 탐색할 수 있다.

**Why this priority**: 요리사 기반 탐색의 핵심 기능. 요리사 상세 조회와 연계.

**Independent Test**: 특정 요리사 ID로 레시피 목록 요청 시 해당 요리사의 레시피만 반환되는지 확인.

**Acceptance Scenarios**:

1. **Given** 특정 요리사가 여러 레시피를 가지고 있을 때, **When** 사용자가 해당 요리사의 레시피를 조회하면, **Then** 해당 요리사의 레시피만 표시된다.
2. **Given** 요리사별 레시피를 조회할 때, **When** 결과가 20개를 초과하면, **Then** 페이지네이션이 적용된다.
3. **Given** 레시피가 없는 요리사를 조회할 때, **When** 사용자가 해당 요리사의 레시피를 요청하면, **Then** 빈 목록과 "아직 등록된 레시피가 없습니다" 메시지가 표시된다.

---

### Edge Cases

- 존재하지 않는 레시피 ID로 조회 시 404 오류 반환
- 존재하지 않는 요리사 ID로 조회 시 404 오류 반환
- 빈 레시피 목록(데이터 없음) 시 빈 배열 반환
- 비활성화된 레시피(`is_active=false`)는 목록에서 제외
- 잘못된 커서 값으로 페이지네이션 요청 시 400 오류 반환
- 음수 또는 과도한 페이지 크기 요청 시 기본값(20) 적용

---

## Requirements *(mandatory)*

### Functional Requirements

**레시피 조회**

- **FR-001**: System MUST 레시피 ID로 상세 정보를 조회할 수 있어야 한다 (제목, 설명, 조리시간, 난이도, 인분수, 썸네일, 영상 URL 포함)
- **FR-002**: System MUST 레시피 상세 조회 시 연결된 재료 목록을 순서대로 반환해야 한다 (재료명, 양, 단위, 대체 재료 포함)
- **FR-003**: System MUST 레시피 상세 조회 시 조리 단계를 순서대로 반환해야 한다 (단계 번호, 설명, 소요시간, 팁, 이미지 URL 포함)
- **FR-004**: System MUST 레시피 상세 조회 시 요리사 정보를 포함해야 한다 (요리사 ID, 이름, 프로필 이미지, 전문 분야)
- **FR-005**: System MUST 레시피 상세 조회 시 연결된 태그 목록을 반환해야 한다
- **FR-006**: System MUST 레시피 목록을 커서 기반 페이지네이션으로 조회할 수 있어야 한다 (기본 20개)
- **FR-007**: System MUST 비활성화된 레시피(`is_active=false`)를 목록에서 제외해야 한다
- **FR-008**: System MUST 인기 레시피를 인기도 점수(`exposure_score`) 기준 내림차순으로 조회할 수 있어야 한다
- **FR-009**: System MUST 카테고리별 인기 레시피 필터링을 지원해야 한다

**요리사 조회**

- **FR-010**: System MUST 요리사 목록을 조회할 수 있어야 한다 (이름, 프로필 이미지, 전문 분야, 레시피 수 포함)
- **FR-011**: System MUST 요리사 ID로 상세 정보를 조회할 수 있어야 한다 (이름, 소개, 전문 분야, 총 조회수, 평균 평점, 검증 여부 포함)
- **FR-012**: System MUST 요리사 상세 조회 시 활동 플랫폼 목록을 반환해야 한다 (플랫폼 종류, URL, 구독자 수 포함)
- **FR-013**: System MUST 인기 요리사를 레시피 수, 총 조회수, 평균 평점 기준으로 조회할 수 있어야 한다
- **FR-014**: System MUST 특정 요리사의 레시피 목록을 조회할 수 있어야 한다

**캐싱**

- **FR-015**: System MUST 레시피 상세 정보를 캐싱하여 반복 조회 성능을 향상시켜야 한다
- **FR-016**: System MUST 요리사 상세 정보를 캐싱하여 반복 조회 성능을 향상시켜야 한다

### Key Entities

- **Chef (요리사)**: 레시피를 만든 원작자. 이름, 정규화된 이름(검색용), 프로필 이미지, 소개, 전문 분야, 레시피 수, 총 조회수, 평균 평점, 검증 여부를 가짐.
- **Chef Platform (요리사 플랫폼)**: 요리사가 활동하는 플랫폼 정보. 플랫폼 종류(youtube, instagram, blog), 플랫폼 ID, URL, 구독자 수를 가짐. 한 요리사가 여러 플랫폼을 가질 수 있음.
- **Recipe (원본 레시피)**: 크롤링으로 수집된 레시피. 제목, 출처 URL, 플랫폼, 설명, 조리시간, 인분수, 난이도, 썸네일, 영상 URL, 품질/인기도/노출 점수, 조회수, 저장수, 조리수, 평균 평점을 가짐. 요리사와 연결됨.
- **Recipe Ingredient (레시피 재료)**: 레시피에 필요한 재료. 재료명, 양, 단위, 순서, 선택 여부, 대체 재료를 가짐.
- **Cooking Step (조리 단계)**: 레시피의 조리 과정. 단계 번호, 설명, 소요시간, 단계 유형, 팁, 이미지 URL을 가짐.
- **Tag (태그)**: 레시피 분류용 태그. 이름, 카테고리(cuisine, meal_type, dish_type, cooking_method, dietary)를 가짐.
- **Recipe Tag (레시피-태그 연결)**: 레시피와 태그의 다대다 관계.
- **Recipe Source (레시피 출처)**: 레시피의 원본 출처 정보. URL, 플랫폼, 수집 일시를 가짐.

---

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 레시피 상세 정보를 1초 이내에 확인할 수 있다
- **SC-002**: 레시피 목록이 0.5초 이내에 로드된다 (첫 페이지 기준)
- **SC-003**: 무한 스크롤 시 추가 레시피가 0.3초 이내에 로드된다
- **SC-004**: 인기 레시피 목록이 매일 자동으로 갱신되어 최신 인기 트렌드를 반영한다
- **SC-005**: 요리사별 레시피 조회 시 해당 요리사의 레시피만 100% 정확하게 필터링된다
- **SC-006**: 비활성화된 레시피가 사용자에게 절대 노출되지 않는다
- **SC-007**: 시스템이 동시 1,000명의 사용자 조회 요청을 처리할 수 있다
- **SC-008**: 레시피 상세 조회 시 모든 연관 정보(재료, 조리 단계, 요리사, 태그)가 누락 없이 표시된다

---

## Assumptions

- 레시피 데이터는 Ingestion Service(SPEC-015)를 통해 사전에 수집되어 있다고 가정
- 요리사 데이터는 레시피 수집 시 자동으로 생성/매칭된다고 가정
- 인증된 사용자와 비인증 사용자 모두 레시피 조회가 가능하다고 가정
- 태그 마스터 데이터는 사전에 정의되어 있다고 가정
- 인기도 점수(`exposure_score`)는 별도 배치 프로세스에 의해 주기적으로 갱신된다고 가정

---

## Dependencies

- **SPEC-000 (Project Setup)**: 서비스 기반 구조 및 공통 모듈
- **SPEC-015 (Recipe Ingestion)**: 레시피 및 요리사 데이터 수집 (데이터 소스)
- **Redis**: 캐싱을 위한 Redis 인프라
- **PostgreSQL**: Recipe DB 스키마
